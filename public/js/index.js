angular.module("Bookmark.controllers",[]),angular.module("Bookmark.services",[]);var Bookmark=angular.module("Bookmark",["ngMaterial","ngAnimate","ngAria","ngMdIcons","Bookmark.controllers","Bookmark.services"]);Bookmark.config(["$mdThemingProvider",function(o){o.theme("default").primaryPalette("blue").accentPalette("red")}]).config(["$mdIconProvider",function(o){o.icon("author","./images/svg/person.svg")}]),angular.module("Bookmark.controllers").controller("AuthorDialogCtrl",["$rootScope","$scope","$mdDialog","Toast","Authors",function(e,o,t,n,r){o.saveAuthor=function(o){r.new(o).then(function(o){o.Books=[],e.authors.push(o),n.show("Author successfully created","top right",3e3),t.cancel()}).catch(function(){n.show("Error creating author","top right",3e3)})}}]),angular.module("Bookmark.controllers").controller("BookDialogCtrl",["$rootScope","$scope","$mdDialog","Toast","Books","bookDetails",function(e,o,t,n,r,a){o.book=a,o.book&&(o.book.publication_date=new Date(o.book.publication_date)),o.saveBook=function(o){o.author_id=e.selectedAuthor.id,r.new(o).then(function(o){n.show("Book successfully created","top right",3e3),e.selectedAuthor.Books.push(o),t.cancel()}).catch(function(){n.show("Error creating book","top right",3e3)})},o.updateBook=function(o){r.update(o).then(function(){n.show("Book successfully updated","top right",3e3),t.cancel()}).catch(function(){n.show("Error updating book","top right",300)})}}]),angular.module("Bookmark.controllers").controller("MainCtrl",["$rootScope","$scope","$mdSidenav","$mdDialog","Authors","Books","Toast",function(e,n,o,r,t,a,l){t.all().then(function(o){e.authors=o,e.selectedAuthor=o[0]}),n.selectAuthor=function(o){e.selectedAuthor=o},n.toggleSidenav=function(){o("left").toggle()},n.newAuthorDialog=function(o){r.show({templateUrl:"views/dialogs/new-author.html",controller:"AuthorDialogCtrl",parent:angular.element(document.body),targetEvent:o,clickOutsideToClose:!0,fullscreen:!0})},n.showAuthorProfile=function(o){r.show({templateUrl:"views/dialogs/author-profile.html",controller:"AuthorDialogCtrl",parent:angular.element(document.body),targetEvent:o,clickOutsideToClose:!0,fullscreen:!0})},n.newBookDialog=function(o){r.show({templateUrl:"views/dialogs/new-book.html",controller:"BookDialogCtrl",locals:{bookDetails:null},parent:angular.element(document.body),targetEvent:o,clickOutsideToClose:!0,fullscreen:!0})},n.deleteBook=function(o,e){var t=r.confirm().title("Delete "+e.name+"?").textContent(e.name+" will be wiped off the face of the earth.").ariaLabel("Delete book").ok("Yes! do it!").cancel("No");r.show(t).then(function(){a.delete(e.id).then(function(){n.selectedAuthor.Books=n.selectedAuthor.Books.filter(function(o){return o.id!==e.id}),l.show(e.name+" has been deleted.","top right",3e3)}).catch(function(o){l.show("Error deleting "+e.name+". Please try again.","top right",3e3)})})},n.editBook=function(o,e){r.show({templateUrl:"views/dialogs/edit-book.html",controller:"BookDialogCtrl",locals:{bookDetails:e},parent:angular.element(document.body),targetEvent:o,clickOutsideToClose:!0,fullscreen:!0})}}]),angular.module("Bookmark.services").factory("Authors",["$http","$q",function(t,n){return{all:function(){var e=n.defer();return t.get("/authors").then(function(o){e.resolve(o.data)}).catch(function(o){e.reject(o)}),e.promise},new:function(o){var e=n.defer();return t.post("/authors",o).then(function(o){e.resolve(o.data)}).catch(function(o){e.reject(o)}),e.promise}}}]),angular.module("Bookmark.services").factory("Books",["$http","$q",function(t,n){return{new:function(o){var e=n.defer();return t.post("/books",o).then(function(o){e.resolve(o.data)}).catch(function(o){e.reject(o)}),e.promise},delete:function(o){var e=n.defer();return t.delete("/books/"+o).then(function(o){e.resolve(o.data)}).catch(function(o){e.reject(o)}),e.promise},update:function(o){var e=n.defer();return t.put("/books/"+o.id,o).then(function(o){e.resolve(o.data)}).catch(function(o){e.reject(o)}),e.promise}}}]),angular.module("Bookmark.services").factory("Toast",["$mdToast",function(n){return{show:function(o,e,t){n.show(n.simple().textContent(o).position(e).hideDelay(t))}}}]);